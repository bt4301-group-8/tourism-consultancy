[2025-04-13T21:53:37.134+0800] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-04-13T21:53:37.143+0800] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: reddit_etl_pipeline.load_to_mongodb scheduled__2025-04-03T00:00:00+00:00 [queued]>
[2025-04-13T21:53:37.147+0800] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: reddit_etl_pipeline.load_to_mongodb scheduled__2025-04-03T00:00:00+00:00 [queued]>
[2025-04-13T21:53:37.147+0800] {taskinstance.py:2867} INFO - Starting attempt 1 of 2
[2025-04-13T21:53:37.161+0800] {taskinstance.py:2890} INFO - Executing <Task(PythonOperator): load_to_mongodb> on 2025-04-03 00:00:00+00:00
[2025-04-13T21:53:37.164+0800] {standard_task_runner.py:72} INFO - Started process 61055 to run task
[2025-04-13T21:53:37.166+0800] {standard_task_runner.py:104} INFO - Running: ['airflow', 'tasks', 'run', 'reddit_etl_pipeline', 'load_to_mongodb', 'scheduled__2025-04-03T00:00:00+00:00', '--job-id', '13', '--raw', '--subdir', 'DAGS_FOLDER/reddit_dag.py', '--cfg-path', '/tmp/tmp8f5izupq']
[2025-04-13T21:53:37.167+0800] {standard_task_runner.py:105} INFO - Job 13: Subtask load_to_mongodb
[2025-04-13T21:53:37.195+0800] {task_command.py:467} INFO - Running <TaskInstance: reddit_etl_pipeline.load_to_mongodb scheduled__2025-04-03T00:00:00+00:00 [running]> on host Conglaptop.
[2025-04-13T21:53:37.234+0800] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='reddit_etl_pipeline' AIRFLOW_CTX_TASK_ID='load_to_mongodb' AIRFLOW_CTX_EXECUTION_DATE='2025-04-03T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-04-03T00:00:00+00:00'
[2025-04-13T21:53:37.235+0800] {logging_mixin.py:190} INFO - Task instance is in running state
[2025-04-13T21:53:37.235+0800] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued
[2025-04-13T21:53:37.236+0800] {logging_mixin.py:190} INFO - Current task name:load_to_mongodb state:running start_date:2025-04-13 13:53:37.143522+00:00
[2025-04-13T21:53:37.236+0800] {logging_mixin.py:190} INFO - Dag name:reddit_etl_pipeline and current dag run status:running
[2025-04-13T21:53:37.236+0800] {taskinstance.py:732} INFO - ::endgroup::
[2025-04-13T21:53:37.236+0800] {reddit_dag.py:152} INFO - Starting data loading to MongoDB at 2025-04-13 21:53:37.236653
[2025-04-13T21:53:37.245+0800] {reddit_dag.py:158} INFO - Data size: 36 submissions, 1424 comments
[2025-04-13T21:53:37.246+0800] {reddit_dag.py:167} INFO - Connecting to MongoDB at cluster0.hw5xcgp.mongodb.net/
[2025-04-13T21:53:39.255+0800] {reddit_dag.py:171} INFO - MongoDB connection successful
[2025-04-13T21:53:39.256+0800] {reddit_dag.py:188} INFO - Processing 36 submissions
[2025-04-13T21:53:39.876+0800] {reddit_dag.py:203} INFO - Submissions progress: 3/36 (8.3%) - Time elapsed: 0:00:02.639761
[2025-04-13T21:53:40.485+0800] {reddit_dag.py:203} INFO - Submissions progress: 6/36 (16.7%) - Time elapsed: 0:00:03.248417
[2025-04-13T21:53:41.079+0800] {reddit_dag.py:203} INFO - Submissions progress: 9/36 (25.0%) - Time elapsed: 0:00:03.842618
[2025-04-13T21:53:41.665+0800] {reddit_dag.py:203} INFO - Submissions progress: 12/36 (33.3%) - Time elapsed: 0:00:04.429294
[2025-04-13T21:53:42.250+0800] {reddit_dag.py:203} INFO - Submissions progress: 15/36 (41.7%) - Time elapsed: 0:00:05.013287
[2025-04-13T21:53:42.833+0800] {reddit_dag.py:203} INFO - Submissions progress: 18/36 (50.0%) - Time elapsed: 0:00:05.596678
[2025-04-13T21:53:43.508+0800] {reddit_dag.py:203} INFO - Submissions progress: 21/36 (58.3%) - Time elapsed: 0:00:06.271822
[2025-04-13T21:53:44.129+0800] {reddit_dag.py:203} INFO - Submissions progress: 24/36 (66.7%) - Time elapsed: 0:00:06.893224
[2025-04-13T21:53:44.709+0800] {reddit_dag.py:203} INFO - Submissions progress: 27/36 (75.0%) - Time elapsed: 0:00:07.473251
[2025-04-13T21:53:45.294+0800] {reddit_dag.py:203} INFO - Submissions progress: 30/36 (83.3%) - Time elapsed: 0:00:08.057465
[2025-04-13T21:53:45.891+0800] {reddit_dag.py:203} INFO - Submissions progress: 33/36 (91.7%) - Time elapsed: 0:00:08.654834
[2025-04-13T21:53:46.501+0800] {reddit_dag.py:203} INFO - Submissions progress: 36/36 (100.0%) - Time elapsed: 0:00:09.265175
[2025-04-13T21:53:46.502+0800] {reddit_dag.py:212} INFO - Processing 1424 comments
[2025-04-13T21:54:01.880+0800] {reddit_dag.py:230} INFO - Comments progress: 71/1424 (5.0%) - Time elapsed: 0:00:15.378163 (total: 0:00:24.644045)
[2025-04-13T21:54:15.866+0800] {reddit_dag.py:230} INFO - Comments progress: 142/1424 (10.0%) - Time elapsed: 0:00:29.364219 (total: 0:00:38.630100)
[2025-04-13T21:54:29.839+0800] {reddit_dag.py:230} INFO - Comments progress: 213/1424 (15.0%) - Time elapsed: 0:00:43.337236 (total: 0:00:52.603117)
[2025-04-13T21:54:45.121+0800] {reddit_dag.py:230} INFO - Comments progress: 284/1424 (19.9%) - Time elapsed: 0:00:58.618732 (total: 0:01:07.884613)
[2025-04-13T21:54:59.101+0800] {reddit_dag.py:230} INFO - Comments progress: 355/1424 (24.9%) - Time elapsed: 0:01:12.598824 (total: 0:01:21.864704)
[2025-04-13T21:55:14.401+0800] {reddit_dag.py:230} INFO - Comments progress: 426/1424 (29.9%) - Time elapsed: 0:01:27.898827 (total: 0:01:37.164707)
[2025-04-13T21:55:28.520+0800] {reddit_dag.py:230} INFO - Comments progress: 497/1424 (34.9%) - Time elapsed: 0:01:42.017818 (total: 0:01:51.283699)
[2025-04-13T21:55:43.773+0800] {reddit_dag.py:230} INFO - Comments progress: 568/1424 (39.9%) - Time elapsed: 0:01:57.270991 (total: 0:02:06.536872)
[2025-04-13T21:55:57.969+0800] {reddit_dag.py:230} INFO - Comments progress: 639/1424 (44.9%) - Time elapsed: 0:02:11.467060 (total: 0:02:20.732940)
[2025-04-13T21:56:11.942+0800] {reddit_dag.py:230} INFO - Comments progress: 710/1424 (49.9%) - Time elapsed: 0:02:25.439551 (total: 0:02:34.705432)
[2025-04-13T21:56:27.190+0800] {reddit_dag.py:230} INFO - Comments progress: 781/1424 (54.8%) - Time elapsed: 0:02:40.687810 (total: 0:02:49.953690)
[2025-04-13T21:56:41.279+0800] {reddit_dag.py:230} INFO - Comments progress: 852/1424 (59.8%) - Time elapsed: 0:02:54.776719 (total: 0:03:04.042601)
[2025-04-13T21:56:56.531+0800] {reddit_dag.py:230} INFO - Comments progress: 923/1424 (64.8%) - Time elapsed: 0:03:10.029298 (total: 0:03:19.295179)
[2025-04-13T21:57:10.560+0800] {reddit_dag.py:230} INFO - Comments progress: 994/1424 (69.8%) - Time elapsed: 0:03:24.057523 (total: 0:03:33.323404)
[2025-04-13T21:57:25.849+0800] {reddit_dag.py:230} INFO - Comments progress: 1065/1424 (74.8%) - Time elapsed: 0:03:39.346453 (total: 0:03:48.612335)
[2025-04-13T21:57:39.905+0800] {reddit_dag.py:230} INFO - Comments progress: 1136/1424 (79.8%) - Time elapsed: 0:03:53.403266 (total: 0:04:02.669149)
[2025-04-13T21:57:55.221+0800] {reddit_dag.py:230} INFO - Comments progress: 1207/1424 (84.8%) - Time elapsed: 0:04:08.719167 (total: 0:04:17.985048)
[2025-04-13T21:58:09.230+0800] {reddit_dag.py:230} INFO - Comments progress: 1278/1424 (89.7%) - Time elapsed: 0:04:22.727731 (total: 0:04:31.993612)
[2025-04-13T21:58:23.065+0800] {reddit_dag.py:230} INFO - Comments progress: 1349/1424 (94.7%) - Time elapsed: 0:04:36.562850 (total: 0:04:45.828730)
[2025-04-13T21:58:38.599+0800] {reddit_dag.py:230} INFO - Comments progress: 1420/1424 (99.7%) - Time elapsed: 0:04:52.096388 (total: 0:05:01.362269)
[2025-04-13T21:58:39.378+0800] {reddit_dag.py:230} INFO - Comments progress: 1424/1424 (100.0%) - Time elapsed: 0:04:52.875540 (total: 0:05:02.141421)
[2025-04-13T21:58:39.378+0800] {reddit_dag.py:241} INFO - MongoDB loading completed in 0:05:02.142132
[2025-04-13T21:58:39.379+0800] {reddit_dag.py:242} INFO - Submissions: 36/36 loaded successfully (100.0%)
[2025-04-13T21:58:39.379+0800] {reddit_dag.py:243} INFO - Comments: 1424/1424 loaded successfully (100.0%)
[2025-04-13T21:58:39.569+0800] {reddit_dag.py:251} INFO - MongoDB connection closed
[2025-04-13T21:58:39.572+0800] {python.py:240} INFO - Done. Returned value was: (36, 1424)
[2025-04-13T21:58:39.595+0800] {taskinstance.py:341} INFO - ::group::Post task execution logs
[2025-04-13T21:58:39.595+0800] {taskinstance.py:353} INFO - Marking task as SUCCESS. dag_id=reddit_etl_pipeline, task_id=load_to_mongodb, run_id=scheduled__2025-04-03T00:00:00+00:00, execution_date=20250403T000000, start_date=20250413T135337, end_date=20250413T135839
[2025-04-13T21:58:39.612+0800] {logging_mixin.py:190} INFO - Task instance in success state
[2025-04-13T21:58:39.612+0800] {logging_mixin.py:190} INFO -  Previous state of the Task instance: running
[2025-04-13T21:58:39.612+0800] {logging_mixin.py:190} INFO - Dag name:reddit_etl_pipeline queued_at:2025-04-13 13:22:15.889254+00:00
[2025-04-13T21:58:39.613+0800] {logging_mixin.py:190} INFO - Task hostname:Conglaptop. operator:PythonOperator
[2025-04-13T21:58:39.646+0800] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-04-13T21:58:39.651+0800] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-04-13T21:58:39.652+0800] {local_task_job_runner.py:245} INFO - ::endgroup::
